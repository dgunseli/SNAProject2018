{% extends "app/layout.html" %}

{% block content %}

<div class="row">
    

    <div class="col-lg-4 bg-light" style="float: left; min-height: 100%; padding-top: 10px;">
        <div class="card">
            <div class="card-header">
                Veri Filtreleme
            </div>
            <div class="card-body">
                <div class="row" style="margin-bottom: 5px">
                    <div class="col">
                        <div class="input-group">
                            <div class="input-group-prepend" style="width:30%">
                                <span class="input-group-text" id="basic-addon1" style="width:100%">Eczane</span>
                            </div>
                            <div class="dropdown" style="width:70%">
                                <button class="btn btn-secondary dropdown-toggle" type="button" id="pharmacyFilter" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="position: static; width: 100%">
                                    Tümü
                                </button>
                                <div class="dropdown-menu form-control" aria-labelledby="dropdownMenuButton">
                                    {% for pharmacy in eczaneListesi %}
                                        <a class="dropdown-item pharmacy-item" val="{{pharmacy.eczane_id}}" href="#">{{pharmacy.eczane_adi}}</a>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                            
                    </div>
                </div>
                <div class="row" style="margin-bottom: 5px">
                    <div class="col">
                        <div class="input-group">
                            <div class="input-group-prepend" style="width:30%">
                                <span class="input-group-text" id="basic-addon1" style="width:100%">Veri Aralığı</span>
                            </div>
                            <input class="form-control" type="text" name="daterange" value="01/01/2018 - 01/15/2018"/>
                        </div>
                    </div>
                </div>

                <div class="row" style="margin-bottom: 5px">
                    <div class="col">
                        <div class="input-group">
                            <div class="input-group-prepend" style="width:30%">
                                <span class="input-group-text" id="basic-addon1" style="width:100%">Firma</span>
                            </div>
                            <div class="dropdown" style="width:70%">
                                <button class="btn btn-secondary dropdown-toggle" type="button" id="firmFilter" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="position: static; width: 100%">
                                    Tümü
                                </button>
                                <div class="dropdown-menu form-control pre-scrollable" aria-labelledby="dropdownMenuButton">
                                    {% for frm in firmaListesi %}
                                        <a class="dropdown-item firm-item" val="{{frm.firma_id}}" href="#">{{frm.firma_adi}}</a>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                            
                    </div>
                </div>
                
                <button type="button" class="btn btn-success btn-lg btn-block" onclick="filterData()">Veri Filtrele</button>
            </div>
        </div>
        <br/>
        
        <div class="card">
            <div class="card-header">
                Graph Özellikleri
            </div>
            <div class="card-body">
                <div class="row" style="margin-bottom: 5px">
                    <div class="col">
                        <div class="input-group">
                            <div class="input-group-prepend" style="width:30%">
                                <span class="input-group-text" id="basic-addon1" style="width:100%">#1 Node</span>
                            </div>
                            <div class="dropdown" style="width:70%">
                                <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="position: static; width: 100%">
                                    Tümü
                                </button>
                                <div class="dropdown-menu form-control" aria-labelledby="dropdownMenuButton">
                                    <a class="dropdown-item" href="#">Tümü</a>
                                    <a class="dropdown-item" href="#">Eczane 1</a>
                                    <a class="dropdown-item" href="#">Eczane 2</a>
                                    <a class="dropdown-item" href="#">Eczane 2</a>
                                </div>
                            </div>
                        </div>
                            
                    </div>
                </div>
                
                <div class="row" style="margin-bottom: 5px">
                    <div class="col">
                        <div class="input-group">
                            <div class="input-group-prepend" style="width:30%">
                                <span class="input-group-text" id="basic-addon1" style="width:100%">#2 Node</span>
                            </div>
                            <div class="dropdown" style="width:70%">
                                <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="position: static; width: 100%">
                                    Tümü
                                </button>
                                <div class="dropdown-menu form-control" aria-labelledby="dropdownMenuButton">
                                    <a class="dropdown-item" href="#">Tümü</a>
                                    <a class="dropdown-item" href="#">Eczane 1</a>
                                    <a class="dropdown-item" href="#">Eczane 2</a>
                                    <a class="dropdown-item" href="#">Eczane 2</a>
                                </div>
                            </div>
                        </div>
                            
                    </div>
                </div>
                
                <div class="row" style="margin-bottom: 5px">
                    <div class="col">
                        <div class="input-group">
                            <div class="input-group-prepend" style="width:30%">
                                <span class="input-group-text" id="basic-addon1" style="width:100%">Projection</span>
                            </div>
                            <div class="dropdown" style="width:70%">
                                <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="position: static; width: 100%">
                                    Tümü
                                </button>
                                <div class="dropdown-menu form-control" aria-labelledby="dropdownMenuButton">
                                    <a class="dropdown-item" href="#">Tümü</a>
                                    <a class="dropdown-item" href="#">Eczane 1</a>
                                    <a class="dropdown-item" href="#">Eczane 2</a>
                                    <a class="dropdown-item" href="#">Eczane 2</a>
                                </div>
                            </div>
                        </div>
                            
                    </div>
                </div>
                

                <div class="row" style="margin-bottom: 5px">
                    <div class="col">
                        <div class="input-group">
                            <div class="input-group-prepend" style="width:30%">
                                <span class="input-group-text" id="basic-addon1" style="width:100%">Node Weight</span>
                            </div>
                            <input type="text" class="form-control" placeholder="Node Weight" aria-label="Node Weight" aria-describedby="basic-addon1">
                        </div>
                    </div>
                </div>
                <button type="button" class="btn btn-primary btn-lg btn-block">Graph Oluştur</button>
            </div>
        </div>
    </div>
    
    <div class="col-lg-7" id="canvas" style="float: left; display: block; height: 100%;">
    </div>
</div>
<script type="text/javascript">
    $('input[name="daterange"]').daterangepicker({
        opens: 'left'
    }, function(start, end, label) {
        console.log("A new date selection was made: " + start.format('YYYY-MM-DD') + ' to ' + end.format('YYYY-MM-DD'));
    });
    debugger;
    var sample = '{{jsonData|safe}}';
    var data_from_django = jQuery.parseJSON(sample);
    var G = new jsnx.Graph();
    debugger;
    for (var i = 0; i < data_from_django.length; i++) {
        G.addEdge(data_from_django[i][0],data_from_django[i][1],{'weight':data_from_django[i][2].weight});
    }
    debugger;
    jsnx.draw(G, {
        element: '#canvas',  
        weighted: true,
        edgeStyle: {
            'stroke-width': 10
        },
        with_labels: true
    });



    $('.pharmacy-item').on('click', function() {
        $('#pharmacyFilter').val($(this).attr('val'));
        $('#pharmacyFilter').html($(this).text());
    });

    $('.firm-item').on('click', function() {
        $('#firmFilter').val($(this).attr('val'));
        $('#firmFilter').html($(this).text());
    });
</script>
{% endblock %}
